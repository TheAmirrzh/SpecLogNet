[2025-10-15 15:14:18] Starting Phase 1 training: phase1_standard_20251015_151415
[2025-10-15 15:14:18] Configuration: {
  "json_dir": "data_processed/phase1_standard_20251015_151415",
  "spectral_dir": "data_processed/phase1_standard_20251015_151415/spectral",
  "val_fraction": 0.1,
  "test_fraction": 0.1,
  "hidden_dim": 64,
  "num_layers": 2,
  "dropout": 0.3,
  "epochs": 50,
  "batch_size": 1,
  "lr": 0.0005,
  "weight_decay": 0.0001,
  "grad_clip": 0.5,
  "patience": 10,
  "exp_name": "phase1_standard_20251015_151415",
  "log_dir": "experiments",
  "device": "cpu",
  "seed": 42
}
[2025-10-15 15:14:18] Using device: cpu
[2025-10-15 15:14:18] Loading datasets...
[2025-10-15 15:14:18] Found 451 JSON files
[2025-10-15 15:14:18] Data split: 361 train, 45 val, 45 test
[2025-10-15 15:14:18] Dataset sizes: 538 train samples, 74 val, 75 test
[2025-10-15 15:14:18] Input features dimension: 19
[2025-10-15 15:14:18] Model parameters: 5,505
[2025-10-15 15:14:18] 
================================================================================
[2025-10-15 15:14:18] Starting training...
[2025-10-15 15:14:18] ================================================================================

[2025-10-15 15:14:18] Epoch 1/50 | Batch 0/538 | Loss: 3.1185
[2025-10-15 15:14:18] Epoch 1/50 | Batch 50/538 | Loss: 3.3786
[2025-10-15 15:14:18] Epoch 1/50 | Batch 100/538 | Loss: 3.1435
[2025-10-15 15:14:18] Epoch 1/50 | Batch 150/538 | Loss: 2.4499
[2025-10-15 15:14:18] Epoch 1/50 | Batch 200/538 | Loss: 3.2153
[2025-10-15 15:14:18] Epoch 1/50 | Batch 250/538 | Loss: 3.5596
[2025-10-15 15:14:18] Epoch 1/50 | Batch 300/538 | Loss: 3.4321
[2025-10-15 15:14:18] Epoch 1/50 | Batch 350/538 | Loss: 3.2116
[2025-10-15 15:14:18] Epoch 1/50 | Batch 400/538 | Loss: 2.1846
[2025-10-15 15:14:18] Epoch 1/50 | Batch 450/538 | Loss: 2.9921
[2025-10-15 15:14:18] Epoch 1/50 | Batch 500/538 | Loss: 3.7018
[2025-10-15 15:14:19] 
Epoch 1/50 completed in 1.4s
  Train Loss:    3.3655
  Train Hit@1:   0.0595
  Val Loss:      3.3800
  Val Hit@1:     0.0405
  Val Hit@3:     0.1081
  Val Hit@10:    0.5811
  Val MRR:       0.1592
  Overfit Gap:   0.0189

[2025-10-15 15:14:19] Saved best checkpoint (epoch 1)
[2025-10-15 15:14:19] Epoch 2/50 | Batch 0/538 | Loss: 3.8560
[2025-10-15 15:14:19] Epoch 2/50 | Batch 50/538 | Loss: 2.3854
[2025-10-15 15:14:19] Epoch 2/50 | Batch 100/538 | Loss: 3.2533
[2025-10-15 15:14:19] Epoch 2/50 | Batch 150/538 | Loss: 3.6040
[2025-10-15 15:14:19] Epoch 2/50 | Batch 200/538 | Loss: 3.4552
[2025-10-15 15:14:19] Epoch 2/50 | Batch 250/538 | Loss: 3.9204
[2025-10-15 15:14:20] Epoch 2/50 | Batch 300/538 | Loss: 3.6073
[2025-10-15 15:14:20] Epoch 2/50 | Batch 350/538 | Loss: 3.6429
[2025-10-15 15:14:20] Epoch 2/50 | Batch 400/538 | Loss: 3.5156
[2025-10-15 15:14:20] Epoch 2/50 | Batch 450/538 | Loss: 2.6680
[2025-10-15 15:14:20] Epoch 2/50 | Batch 500/538 | Loss: 2.0522
[2025-10-15 15:14:21] 
Epoch 2/50 completed in 1.4s
  Train Loss:    3.1884
  Train Hit@1:   0.0483
  Val Loss:      3.2198
  Val Hit@1:     0.0270
  Val Hit@3:     0.1081
  Val Hit@10:    0.5946
  Val MRR:       0.1643
  Overfit Gap:   0.0213

[2025-10-15 15:14:21] Epoch 3/50 | Batch 0/538 | Loss: 2.5603
[2025-10-15 15:14:21] Epoch 3/50 | Batch 50/538 | Loss: 3.0049
[2025-10-15 15:14:21] Epoch 3/50 | Batch 100/538 | Loss: 2.7534
[2025-10-15 15:14:21] Epoch 3/50 | Batch 150/538 | Loss: 3.2424
[2025-10-15 15:14:21] Epoch 3/50 | Batch 200/538 | Loss: 3.3274
[2025-10-15 15:14:21] Epoch 3/50 | Batch 250/538 | Loss: 3.3162
[2025-10-15 15:14:21] Epoch 3/50 | Batch 300/538 | Loss: 2.3031
[2025-10-15 15:14:21] Epoch 3/50 | Batch 350/538 | Loss: 3.8303
[2025-10-15 15:14:21] Epoch 3/50 | Batch 400/538 | Loss: 4.4761
[2025-10-15 15:14:21] Epoch 3/50 | Batch 450/538 | Loss: 2.6290
[2025-10-15 15:14:21] Epoch 3/50 | Batch 500/538 | Loss: 3.0177
[2025-10-15 15:14:22] 
Epoch 3/50 completed in 1.6s
  Train Loss:    3.1307
  Train Hit@1:   0.0539
  Val Loss:      3.1840
  Val Hit@1:     0.0405
  Val Hit@3:     0.1351
  Val Hit@10:    0.6351
  Val MRR:       0.1752
  Overfit Gap:   0.0134

[2025-10-15 15:14:22] Epoch 4/50 | Batch 0/538 | Loss: 4.7874
[2025-10-15 15:14:22] Epoch 4/50 | Batch 50/538 | Loss: 3.9510
[2025-10-15 15:14:22] Epoch 4/50 | Batch 100/538 | Loss: 3.8835
[2025-10-15 15:14:22] Epoch 4/50 | Batch 150/538 | Loss: 2.2403
[2025-10-15 15:14:22] Epoch 4/50 | Batch 200/538 | Loss: 2.5391
[2025-10-15 15:14:23] Epoch 4/50 | Batch 250/538 | Loss: 3.1183
[2025-10-15 15:14:23] Epoch 4/50 | Batch 300/538 | Loss: 1.5924
[2025-10-15 15:14:23] Epoch 4/50 | Batch 350/538 | Loss: 2.5711
[2025-10-15 15:14:23] Epoch 4/50 | Batch 400/538 | Loss: 3.7869
[2025-10-15 15:14:23] Epoch 4/50 | Batch 450/538 | Loss: 4.1573
[2025-10-15 15:14:23] Epoch 4/50 | Batch 500/538 | Loss: 2.3691
[2025-10-15 15:14:23] 
Epoch 4/50 completed in 1.3s
  Train Loss:    3.0821
  Train Hit@1:   0.0502
  Val Loss:      3.1396
  Val Hit@1:     0.0541
  Val Hit@3:     0.1757
  Val Hit@10:    0.6216
  Val MRR:       0.1962
  Overfit Gap:   -0.0039

[2025-10-15 15:14:24] Saved best checkpoint (epoch 4)
[2025-10-15 15:14:24] Epoch 5/50 | Batch 0/538 | Loss: 3.5972
[2025-10-15 15:14:24] Epoch 5/50 | Batch 50/538 | Loss: 2.7957
[2025-10-15 15:14:24] Epoch 5/50 | Batch 100/538 | Loss: 4.1435
[2025-10-15 15:14:24] Epoch 5/50 | Batch 150/538 | Loss: 3.2385
[2025-10-15 15:14:24] Epoch 5/50 | Batch 200/538 | Loss: 4.4267
[2025-10-15 15:14:24] Epoch 5/50 | Batch 250/538 | Loss: 2.7390
[2025-10-15 15:14:24] Epoch 5/50 | Batch 300/538 | Loss: 4.4761
[2025-10-15 15:14:24] Epoch 5/50 | Batch 350/538 | Loss: 3.8027
[2025-10-15 15:14:24] Epoch 5/50 | Batch 400/538 | Loss: 2.5634
[2025-10-15 15:14:24] Epoch 5/50 | Batch 450/538 | Loss: 3.3998
[2025-10-15 15:14:24] Epoch 5/50 | Batch 500/538 | Loss: 2.2959
[2025-10-15 15:14:25] 
Epoch 5/50 completed in 1.4s
  Train Loss:    3.0787
  Train Hit@1:   0.0632
  Val Loss:      3.1495
  Val Hit@1:     0.0270
  Val Hit@3:     0.2027
  Val Hit@10:    0.6351
  Val MRR:       0.1939
  Overfit Gap:   0.0362

[2025-10-15 15:14:25] Epoch 6/50 | Batch 0/538 | Loss: 3.1949
[2025-10-15 15:14:25] Epoch 6/50 | Batch 50/538 | Loss: 2.5450
[2025-10-15 15:14:25] Epoch 6/50 | Batch 100/538 | Loss: 2.2166
[2025-10-15 15:14:25] Epoch 6/50 | Batch 150/538 | Loss: 4.6606
[2025-10-15 15:14:25] Epoch 6/50 | Batch 200/538 | Loss: 3.1796
[2025-10-15 15:14:25] Epoch 6/50 | Batch 250/538 | Loss: 3.8273
[2025-10-15 15:14:25] Epoch 6/50 | Batch 300/538 | Loss: 4.5258
[2025-10-15 15:14:25] Epoch 6/50 | Batch 350/538 | Loss: 2.9730
[2025-10-15 15:14:25] Epoch 6/50 | Batch 400/538 | Loss: 4.1639
[2025-10-15 15:14:26] Epoch 6/50 | Batch 450/538 | Loss: 2.9715
[2025-10-15 15:14:26] Epoch 6/50 | Batch 500/538 | Loss: 3.8076
[2025-10-15 15:14:26] 
Epoch 6/50 completed in 1.4s
  Train Loss:    3.0281
  Train Hit@1:   0.0632
  Val Loss:      3.1067
  Val Hit@1:     0.0541
  Val Hit@3:     0.2027
  Val Hit@10:    0.6351
  Val MRR:       0.2109
  Overfit Gap:   0.0091

[2025-10-15 15:14:26] Epoch 7/50 | Batch 0/538 | Loss: 3.9665
[2025-10-15 15:14:26] Epoch 7/50 | Batch 50/538 | Loss: 2.1562
[2025-10-15 15:14:26] Epoch 7/50 | Batch 100/538 | Loss: 3.5696
[2025-10-15 15:14:27] Epoch 7/50 | Batch 150/538 | Loss: 5.3934
[2025-10-15 15:14:27] Epoch 7/50 | Batch 200/538 | Loss: 2.6572
[2025-10-15 15:14:27] Epoch 7/50 | Batch 250/538 | Loss: 4.2354
[2025-10-15 15:14:27] Epoch 7/50 | Batch 300/538 | Loss: 2.7764
[2025-10-15 15:14:27] Epoch 7/50 | Batch 350/538 | Loss: 2.7109
[2025-10-15 15:14:27] Epoch 7/50 | Batch 400/538 | Loss: 2.0628
[2025-10-15 15:14:27] Epoch 7/50 | Batch 450/538 | Loss: 3.0544
[2025-10-15 15:14:27] Epoch 7/50 | Batch 500/538 | Loss: 2.4422
[2025-10-15 15:14:28] 
Epoch 7/50 completed in 1.5s
  Train Loss:    3.0287
  Train Hit@1:   0.0762
  Val Loss:      3.0947
  Val Hit@1:     0.0676
  Val Hit@3:     0.2027
  Val Hit@10:    0.6486
  Val MRR:       0.2206
  Overfit Gap:   0.0086

[2025-10-15 15:14:28] Saved best checkpoint (epoch 7)
[2025-10-15 15:14:28] Epoch 8/50 | Batch 0/538 | Loss: 3.5851
[2025-10-15 15:14:28] Epoch 8/50 | Batch 50/538 | Loss: 3.2043
[2025-10-15 15:14:28] Epoch 8/50 | Batch 100/538 | Loss: 3.0402
[2025-10-15 15:14:28] Epoch 8/50 | Batch 150/538 | Loss: 1.8737
[2025-10-15 15:14:28] Epoch 8/50 | Batch 200/538 | Loss: 2.4714
[2025-10-15 15:14:28] Epoch 8/50 | Batch 250/538 | Loss: 3.3032
[2025-10-15 15:14:28] Epoch 8/50 | Batch 300/538 | Loss: 2.9614
[2025-10-15 15:14:28] Epoch 8/50 | Batch 350/538 | Loss: 2.2023
[2025-10-15 15:14:28] Epoch 8/50 | Batch 400/538 | Loss: 4.0142
[2025-10-15 15:14:28] Epoch 8/50 | Batch 450/538 | Loss: 2.0336
[2025-10-15 15:14:28] Epoch 8/50 | Batch 500/538 | Loss: 3.0928
[2025-10-15 15:14:29] 
Epoch 8/50 completed in 1.4s
  Train Loss:    3.0072
  Train Hit@1:   0.0874
  Val Loss:      3.0814
  Val Hit@1:     0.0676
  Val Hit@3:     0.2432
  Val Hit@10:    0.6622
  Val MRR:       0.2294
  Overfit Gap:   0.0198

[2025-10-15 15:14:29] Epoch 9/50 | Batch 0/538 | Loss: 1.8294
[2025-10-15 15:14:29] Epoch 9/50 | Batch 50/538 | Loss: 4.5977
[2025-10-15 15:14:29] Epoch 9/50 | Batch 100/538 | Loss: 3.6009
[2025-10-15 15:14:29] Epoch 9/50 | Batch 150/538 | Loss: 2.2273
[2025-10-15 15:14:29] Epoch 9/50 | Batch 200/538 | Loss: 2.2320
[2025-10-15 15:14:30] Epoch 9/50 | Batch 250/538 | Loss: 3.4688
[2025-10-15 15:14:30] Epoch 9/50 | Batch 300/538 | Loss: 4.2896
[2025-10-15 15:14:30] Epoch 9/50 | Batch 350/538 | Loss: 4.4281
[2025-10-15 15:14:30] Epoch 9/50 | Batch 400/538 | Loss: 5.8235
[2025-10-15 15:14:30] Epoch 9/50 | Batch 450/538 | Loss: 2.4628
[2025-10-15 15:14:30] Epoch 9/50 | Batch 500/538 | Loss: 1.7651
[2025-10-15 15:14:31] 
Epoch 9/50 completed in 1.4s
  Train Loss:    3.0268
  Train Hit@1:   0.0874
  Val Loss:      3.0484
  Val Hit@1:     0.0946
  Val Hit@3:     0.2838
  Val Hit@10:    0.6486
  Val MRR:       0.2528
  Overfit Gap:   -0.0072

[2025-10-15 15:14:31] Saved best checkpoint (epoch 9)
[2025-10-15 15:14:31] Epoch 10/50 | Batch 0/538 | Loss: 1.3130
[2025-10-15 15:14:31] Epoch 10/50 | Batch 50/538 | Loss: 2.0117
[2025-10-15 15:14:31] Epoch 10/50 | Batch 100/538 | Loss: 2.3216
[2025-10-15 15:14:31] Epoch 10/50 | Batch 150/538 | Loss: 2.6575
[2025-10-15 15:14:31] Epoch 10/50 | Batch 200/538 | Loss: 4.1547
[2025-10-15 15:14:31] Epoch 10/50 | Batch 250/538 | Loss: 4.2115
[2025-10-15 15:14:31] Epoch 10/50 | Batch 300/538 | Loss: 1.2484
[2025-10-15 15:14:31] Epoch 10/50 | Batch 350/538 | Loss: 2.0265
[2025-10-15 15:14:31] Epoch 10/50 | Batch 400/538 | Loss: 3.1081
[2025-10-15 15:14:31] Epoch 10/50 | Batch 450/538 | Loss: 1.8054
[2025-10-15 15:14:31] Epoch 10/50 | Batch 500/538 | Loss: 3.6502
[2025-10-15 15:14:32] 
Epoch 10/50 completed in 1.4s
  Train Loss:    2.9655
  Train Hit@1:   0.1041
  Val Loss:      3.0604
  Val Hit@1:     0.0946
  Val Hit@3:     0.2568
  Val Hit@10:    0.6757
  Val MRR:       0.2494
  Overfit Gap:   0.0095

[2025-10-15 15:14:32] Epoch 11/50 | Batch 0/538 | Loss: 1.6671
[2025-10-15 15:14:32] Epoch 11/50 | Batch 50/538 | Loss: 3.2960
[2025-10-15 15:14:32] Epoch 11/50 | Batch 100/538 | Loss: 3.3022
[2025-10-15 15:14:32] Epoch 11/50 | Batch 150/538 | Loss: 3.6416
[2025-10-15 15:14:32] Epoch 11/50 | Batch 200/538 | Loss: 3.7925
[2025-10-15 15:14:32] Epoch 11/50 | Batch 250/538 | Loss: 3.9665
[2025-10-15 15:14:32] Epoch 11/50 | Batch 300/538 | Loss: 3.7754
[2025-10-15 15:14:32] Epoch 11/50 | Batch 350/538 | Loss: 4.1302
[2025-10-15 15:14:33] Epoch 11/50 | Batch 400/538 | Loss: 2.9666
[2025-10-15 15:14:33] Epoch 11/50 | Batch 450/538 | Loss: 2.7550
[2025-10-15 15:14:33] Epoch 11/50 | Batch 500/538 | Loss: 1.6470
[2025-10-15 15:14:33] 
Epoch 11/50 completed in 1.4s
  Train Loss:    2.9685
  Train Hit@1:   0.1190
  Val Loss:      3.1008
  Val Hit@1:     0.0811
  Val Hit@3:     0.2838
  Val Hit@10:    0.6486
  Val MRR:       0.2404
  Overfit Gap:   0.0379

[2025-10-15 15:14:33] Epoch 12/50 | Batch 0/538 | Loss: 2.9952
[2025-10-15 15:14:33] Epoch 12/50 | Batch 50/538 | Loss: 3.6138
[2025-10-15 15:14:33] Epoch 12/50 | Batch 100/538 | Loss: 4.9709
[2025-10-15 15:14:34] Epoch 12/50 | Batch 150/538 | Loss: 2.3822
[2025-10-15 15:14:34] Epoch 12/50 | Batch 200/538 | Loss: 0.8924
[2025-10-15 15:14:34] Epoch 12/50 | Batch 250/538 | Loss: 4.9409
[2025-10-15 15:14:34] Epoch 12/50 | Batch 300/538 | Loss: 2.2987
[2025-10-15 15:14:34] Epoch 12/50 | Batch 350/538 | Loss: 4.0839
[2025-10-15 15:14:34] Epoch 12/50 | Batch 400/538 | Loss: 3.6329
[2025-10-15 15:14:34] Epoch 12/50 | Batch 450/538 | Loss: 3.3039
[2025-10-15 15:14:34] Epoch 12/50 | Batch 500/538 | Loss: 2.9727
[2025-10-15 15:14:35] 
Epoch 12/50 completed in 1.4s
  Train Loss:    2.9401
  Train Hit@1:   0.1152
  Val Loss:      3.0648
  Val Hit@1:     0.0676
  Val Hit@3:     0.2838
  Val Hit@10:    0.6622
  Val MRR:       0.2412
  Overfit Gap:   0.0477

[2025-10-15 15:14:35] Epoch 13/50 | Batch 0/538 | Loss: 2.8662
[2025-10-15 15:14:35] Epoch 13/50 | Batch 50/538 | Loss: 2.0635
[2025-10-15 15:14:35] Epoch 13/50 | Batch 100/538 | Loss: 1.5142
[2025-10-15 15:14:35] Epoch 13/50 | Batch 150/538 | Loss: 3.4822
[2025-10-15 15:14:35] Epoch 13/50 | Batch 200/538 | Loss: 1.8116
[2025-10-15 15:14:35] Epoch 13/50 | Batch 250/538 | Loss: 3.3867
[2025-10-15 15:14:35] Epoch 13/50 | Batch 300/538 | Loss: 1.1388
[2025-10-15 15:14:35] Epoch 13/50 | Batch 350/538 | Loss: 2.3052
[2025-10-15 15:14:35] Epoch 13/50 | Batch 400/538 | Loss: 2.8322
[2025-10-15 15:14:35] Epoch 13/50 | Batch 450/538 | Loss: 3.7084
[2025-10-15 15:14:35] Epoch 13/50 | Batch 500/538 | Loss: 3.7916
[2025-10-15 15:14:36] 
Epoch 13/50 completed in 1.4s
  Train Loss:    2.9434
  Train Hit@1:   0.1338
  Val Loss:      3.0723
  Val Hit@1:     0.0676
  Val Hit@3:     0.3108
  Val Hit@10:    0.6622
  Val MRR:       0.2472
  Overfit Gap:   0.0663

[2025-10-15 15:14:36] Epoch 14/50 | Batch 0/538 | Loss: 4.1279
[2025-10-15 15:14:36] Epoch 14/50 | Batch 50/538 | Loss: 1.4365
[2025-10-15 15:14:36] Epoch 14/50 | Batch 100/538 | Loss: 2.1484
[2025-10-15 15:14:36] Epoch 14/50 | Batch 150/538 | Loss: 1.5121
[2025-10-15 15:14:36] Epoch 14/50 | Batch 200/538 | Loss: 3.4762
[2025-10-15 15:14:36] Epoch 14/50 | Batch 250/538 | Loss: 3.0529
[2025-10-15 15:14:36] Epoch 14/50 | Batch 300/538 | Loss: 3.0131
[2025-10-15 15:14:37] Epoch 14/50 | Batch 350/538 | Loss: 2.4871
[2025-10-15 15:14:37] Epoch 14/50 | Batch 400/538 | Loss: 4.1237
[2025-10-15 15:14:37] Epoch 14/50 | Batch 450/538 | Loss: 2.9789
[2025-10-15 15:14:37] Epoch 14/50 | Batch 500/538 | Loss: 2.6769
[2025-10-15 15:14:37] 
Epoch 14/50 completed in 1.3s
  Train Loss:    2.9549
  Train Hit@1:   0.1357
  Val Loss:      3.0498
  Val Hit@1:     0.0946
  Val Hit@3:     0.2838
  Val Hit@10:    0.6757
  Val MRR:       0.2568
  Overfit Gap:   0.0411

[2025-10-15 15:14:37] Epoch 15/50 | Batch 0/538 | Loss: 4.6805
[2025-10-15 15:14:37] Epoch 15/50 | Batch 50/538 | Loss: 2.4592
[2025-10-15 15:14:38] Epoch 15/50 | Batch 100/538 | Loss: 0.8119
[2025-10-15 15:14:38] Epoch 15/50 | Batch 150/538 | Loss: 1.7614
[2025-10-15 15:14:38] Epoch 15/50 | Batch 200/538 | Loss: 3.6635
[2025-10-15 15:14:38] Epoch 15/50 | Batch 250/538 | Loss: 2.5929
[2025-10-15 15:14:38] Epoch 15/50 | Batch 300/538 | Loss: 2.0001
[2025-10-15 15:14:38] Epoch 15/50 | Batch 350/538 | Loss: 3.6046
[2025-10-15 15:14:38] Epoch 15/50 | Batch 400/538 | Loss: 2.2479
[2025-10-15 15:14:38] Epoch 15/50 | Batch 450/538 | Loss: 3.9921
[2025-10-15 15:14:38] Epoch 15/50 | Batch 500/538 | Loss: 2.7821
[2025-10-15 15:14:39] 
Epoch 15/50 completed in 1.3s
  Train Loss:    2.8716
  Train Hit@1:   0.1561
  Val Loss:      3.0893
  Val Hit@1:     0.0811
  Val Hit@3:     0.2703
  Val Hit@10:    0.6622
  Val MRR:       0.2509
  Overfit Gap:   0.0751

[2025-10-15 15:14:39] Epoch 16/50 | Batch 0/538 | Loss: 2.5096
[2025-10-15 15:14:39] Epoch 16/50 | Batch 50/538 | Loss: 2.8536
[2025-10-15 15:14:39] Epoch 16/50 | Batch 100/538 | Loss: 1.9957
[2025-10-15 15:14:39] Epoch 16/50 | Batch 150/538 | Loss: 3.4071
[2025-10-15 15:14:39] Epoch 16/50 | Batch 200/538 | Loss: 3.9123
[2025-10-15 15:14:39] Epoch 16/50 | Batch 250/538 | Loss: 2.5016
[2025-10-15 15:14:39] Epoch 16/50 | Batch 300/538 | Loss: 3.3856
[2025-10-15 15:14:39] Epoch 16/50 | Batch 350/538 | Loss: 2.2146
[2025-10-15 15:14:39] Epoch 16/50 | Batch 400/538 | Loss: 1.2196
[2025-10-15 15:14:39] Epoch 16/50 | Batch 450/538 | Loss: 3.6760
[2025-10-15 15:14:39] Epoch 16/50 | Batch 500/538 | Loss: 2.7540
[2025-10-15 15:14:40] 
Epoch 16/50 completed in 1.4s
  Train Loss:    2.8600
  Train Hit@1:   0.1747
  Val Loss:      3.0692
  Val Hit@1:     0.0946
  Val Hit@3:     0.2973
  Val Hit@10:    0.6622
  Val MRR:       0.2576
  Overfit Gap:   0.0801

[2025-10-15 15:14:40] Epoch 17/50 | Batch 0/538 | Loss: 3.1021
[2025-10-15 15:14:40] Epoch 17/50 | Batch 50/538 | Loss: 3.6713
[2025-10-15 15:14:40] Epoch 17/50 | Batch 100/538 | Loss: 2.5950
[2025-10-15 15:14:40] Epoch 17/50 | Batch 150/538 | Loss: 2.8201
[2025-10-15 15:14:40] Epoch 17/50 | Batch 200/538 | Loss: 1.4914
[2025-10-15 15:14:40] Epoch 17/50 | Batch 250/538 | Loss: 2.8017
[2025-10-15 15:14:41] Epoch 17/50 | Batch 300/538 | Loss: 3.2490
[2025-10-15 15:14:41] Epoch 17/50 | Batch 350/538 | Loss: 1.0764
[2025-10-15 15:14:41] Epoch 17/50 | Batch 400/538 | Loss: 1.9769
[2025-10-15 15:14:41] Epoch 17/50 | Batch 450/538 | Loss: 3.8274
[2025-10-15 15:14:41] Epoch 17/50 | Batch 500/538 | Loss: 2.7873
[2025-10-15 15:14:41] 
Epoch 17/50 completed in 1.4s
  Train Loss:    2.8691
  Train Hit@1:   0.1747
  Val Loss:      3.0787
  Val Hit@1:     0.1081
  Val Hit@3:     0.2973
  Val Hit@10:    0.6622
  Val MRR:       0.2684
  Overfit Gap:   0.0666

[2025-10-15 15:14:41] Saved best checkpoint (epoch 17)
[2025-10-15 15:14:41] Epoch 18/50 | Batch 0/538 | Loss: 0.9305
[2025-10-15 15:14:42] Epoch 18/50 | Batch 50/538 | Loss: 3.1556
[2025-10-15 15:14:42] Epoch 18/50 | Batch 100/538 | Loss: 2.2812
[2025-10-15 15:14:42] Epoch 18/50 | Batch 150/538 | Loss: 1.6867
[2025-10-15 15:14:42] Epoch 18/50 | Batch 200/538 | Loss: 3.4829
[2025-10-15 15:14:42] Epoch 18/50 | Batch 250/538 | Loss: 3.9779
[2025-10-15 15:14:42] Epoch 18/50 | Batch 300/538 | Loss: 2.8584
[2025-10-15 15:14:42] Epoch 18/50 | Batch 350/538 | Loss: 1.9735
[2025-10-15 15:14:42] Epoch 18/50 | Batch 400/538 | Loss: 2.2339
[2025-10-15 15:14:42] Epoch 18/50 | Batch 450/538 | Loss: 3.1778
[2025-10-15 15:14:42] Epoch 18/50 | Batch 500/538 | Loss: 2.7037
[2025-10-15 15:14:43] 
Epoch 18/50 completed in 1.5s
  Train Loss:    2.8348
  Train Hit@1:   0.1729
  Val Loss:      3.0895
  Val Hit@1:     0.1216
  Val Hit@3:     0.2838
  Val Hit@10:    0.6486
  Val MRR:       0.2674
  Overfit Gap:   0.0512

[2025-10-15 15:14:43] Saved best checkpoint (epoch 18)
[2025-10-15 15:14:43] Epoch 19/50 | Batch 0/538 | Loss: 4.3338
[2025-10-15 15:14:43] Epoch 19/50 | Batch 50/538 | Loss: 1.8774
[2025-10-15 15:14:43] Epoch 19/50 | Batch 100/538 | Loss: 3.0572
[2025-10-15 15:14:43] Epoch 19/50 | Batch 150/538 | Loss: 2.0213
[2025-10-15 15:14:43] Epoch 19/50 | Batch 200/538 | Loss: 1.8381
[2025-10-15 15:14:43] Epoch 19/50 | Batch 250/538 | Loss: 3.1407
[2025-10-15 15:14:43] Epoch 19/50 | Batch 300/538 | Loss: 1.7662
[2025-10-15 15:14:43] Epoch 19/50 | Batch 350/538 | Loss: 2.7737
[2025-10-15 15:14:44] Epoch 19/50 | Batch 400/538 | Loss: 2.8917
[2025-10-15 15:14:44] Epoch 19/50 | Batch 450/538 | Loss: 3.5184
[2025-10-15 15:14:44] Epoch 19/50 | Batch 500/538 | Loss: 1.5980
[2025-10-15 15:14:44] 
Epoch 19/50 completed in 1.4s
  Train Loss:    2.8680
  Train Hit@1:   0.1822
  Val Loss:      3.0853
  Val Hit@1:     0.1351
  Val Hit@3:     0.3108
  Val Hit@10:    0.6757
  Val MRR:       0.2822
  Overfit Gap:   0.0470

[2025-10-15 15:14:44] Saved best checkpoint (epoch 19)
[2025-10-15 15:14:44] Epoch 20/50 | Batch 0/538 | Loss: 4.2031
[2025-10-15 15:14:44] Epoch 20/50 | Batch 50/538 | Loss: 3.3378
[2025-10-15 15:14:45] Epoch 20/50 | Batch 100/538 | Loss: 3.4613
[2025-10-15 15:14:45] Epoch 20/50 | Batch 150/538 | Loss: 5.2455
[2025-10-15 15:14:45] Epoch 20/50 | Batch 200/538 | Loss: 2.3787
[2025-10-15 15:14:45] Epoch 20/50 | Batch 250/538 | Loss: 3.0131
[2025-10-15 15:14:45] Epoch 20/50 | Batch 300/538 | Loss: 2.5199
[2025-10-15 15:14:45] Epoch 20/50 | Batch 350/538 | Loss: 1.0167
[2025-10-15 15:14:45] Epoch 20/50 | Batch 400/538 | Loss: 2.3320
[2025-10-15 15:14:45] Epoch 20/50 | Batch 450/538 | Loss: 0.8322
[2025-10-15 15:14:45] Epoch 20/50 | Batch 500/538 | Loss: 3.3003
[2025-10-15 15:14:46] 
Epoch 20/50 completed in 1.4s
  Train Loss:    2.8723
  Train Hit@1:   0.1803
  Val Loss:      3.0762
  Val Hit@1:     0.1216
  Val Hit@3:     0.2973
  Val Hit@10:    0.6757
  Val MRR:       0.2745
  Overfit Gap:   0.0587

[2025-10-15 15:14:46] Epoch 21/50 | Batch 0/538 | Loss: 3.6371
[2025-10-15 15:14:46] Epoch 21/50 | Batch 50/538 | Loss: 3.1214
[2025-10-15 15:14:46] Epoch 21/50 | Batch 100/538 | Loss: 2.4573
[2025-10-15 15:14:46] Epoch 21/50 | Batch 150/538 | Loss: 2.2166
[2025-10-15 15:14:46] Epoch 21/50 | Batch 200/538 | Loss: 2.8955
[2025-10-15 15:14:46] Epoch 21/50 | Batch 250/538 | Loss: 4.4628
[2025-10-15 15:14:46] Epoch 21/50 | Batch 300/538 | Loss: 2.6183
[2025-10-15 15:14:46] Epoch 21/50 | Batch 350/538 | Loss: 3.2241
[2025-10-15 15:14:46] Epoch 21/50 | Batch 400/538 | Loss: 2.6325
[2025-10-15 15:14:46] Epoch 21/50 | Batch 450/538 | Loss: 1.2378
[2025-10-15 15:14:46] Epoch 21/50 | Batch 500/538 | Loss: 4.6442
[2025-10-15 15:14:47] 
Epoch 21/50 completed in 1.3s
  Train Loss:    2.8461
  Train Hit@1:   0.1822
  Val Loss:      3.0877
  Val Hit@1:     0.0946
  Val Hit@3:     0.3108
  Val Hit@10:    0.6757
  Val MRR:       0.2588
  Overfit Gap:   0.0876

[2025-10-15 15:14:47] Epoch 22/50 | Batch 0/538 | Loss: 2.9113
[2025-10-15 15:14:47] Epoch 22/50 | Batch 50/538 | Loss: 4.2747
[2025-10-15 15:14:47] Epoch 22/50 | Batch 100/538 | Loss: 3.1635
[2025-10-15 15:14:47] Epoch 22/50 | Batch 150/538 | Loss: 1.9156
[2025-10-15 15:14:47] Epoch 22/50 | Batch 200/538 | Loss: 1.5402
[2025-10-15 15:14:47] Epoch 22/50 | Batch 250/538 | Loss: 3.8740
[2025-10-15 15:14:47] Epoch 22/50 | Batch 300/538 | Loss: 4.5614
[2025-10-15 15:14:48] Epoch 22/50 | Batch 350/538 | Loss: 1.4073
[2025-10-15 15:14:48] Epoch 22/50 | Batch 400/538 | Loss: 1.7026
[2025-10-15 15:14:48] Epoch 22/50 | Batch 450/538 | Loss: 1.5942
[2025-10-15 15:14:48] Epoch 22/50 | Batch 500/538 | Loss: 5.3306
[2025-10-15 15:14:48] 
Epoch 22/50 completed in 1.3s
  Train Loss:    2.8110
  Train Hit@1:   0.1970
  Val Loss:      3.0772
  Val Hit@1:     0.1216
  Val Hit@3:     0.3108
  Val Hit@10:    0.6622
  Val MRR:       0.2750
  Overfit Gap:   0.0754

[2025-10-15 15:14:48] Epoch 23/50 | Batch 0/538 | Loss: 3.1153
[2025-10-15 15:14:48] Epoch 23/50 | Batch 50/538 | Loss: 1.2832
[2025-10-15 15:14:49] Epoch 23/50 | Batch 100/538 | Loss: 1.5516
[2025-10-15 15:14:49] Epoch 23/50 | Batch 150/538 | Loss: 2.1903
[2025-10-15 15:14:49] Epoch 23/50 | Batch 200/538 | Loss: 3.3692
[2025-10-15 15:14:49] Epoch 23/50 | Batch 250/538 | Loss: 3.1277
[2025-10-15 15:14:49] Epoch 23/50 | Batch 300/538 | Loss: 3.4507
[2025-10-15 15:14:49] Epoch 23/50 | Batch 350/538 | Loss: 3.0413
[2025-10-15 15:14:49] Epoch 23/50 | Batch 400/538 | Loss: 1.1335
[2025-10-15 15:14:49] Epoch 23/50 | Batch 450/538 | Loss: 3.8898
[2025-10-15 15:14:49] Epoch 23/50 | Batch 500/538 | Loss: 2.3529
[2025-10-15 15:14:50] 
Epoch 23/50 completed in 1.3s
  Train Loss:    2.8065
  Train Hit@1:   0.1989
  Val Loss:      3.0909
  Val Hit@1:     0.1081
  Val Hit@3:     0.3243
  Val Hit@10:    0.6622
  Val MRR:       0.2698
  Overfit Gap:   0.0908

[2025-10-15 15:14:50] Epoch 24/50 | Batch 0/538 | Loss: 2.1153
[2025-10-15 15:14:50] Epoch 24/50 | Batch 50/538 | Loss: 4.0673
[2025-10-15 15:14:50] Epoch 24/50 | Batch 100/538 | Loss: 2.7936
[2025-10-15 15:14:50] Epoch 24/50 | Batch 150/538 | Loss: 1.1932
[2025-10-15 15:14:50] Epoch 24/50 | Batch 200/538 | Loss: 3.7961
[2025-10-15 15:14:50] Epoch 24/50 | Batch 250/538 | Loss: 1.9696
[2025-10-15 15:14:50] Epoch 24/50 | Batch 300/538 | Loss: 2.0781
[2025-10-15 15:14:50] Epoch 24/50 | Batch 350/538 | Loss: 2.1827
[2025-10-15 15:14:50] Epoch 24/50 | Batch 400/538 | Loss: 1.5263
[2025-10-15 15:14:50] Epoch 24/50 | Batch 450/538 | Loss: 4.0028
[2025-10-15 15:14:50] Epoch 24/50 | Batch 500/538 | Loss: 3.4935
[2025-10-15 15:14:51] 
Epoch 24/50 completed in 1.4s
  Train Loss:    2.8551
  Train Hit@1:   0.2026
  Val Loss:      3.0783
  Val Hit@1:     0.0946
  Val Hit@3:     0.3243
  Val Hit@10:    0.6757
  Val MRR:       0.2642
  Overfit Gap:   0.1080

[2025-10-15 15:14:51] Epoch 25/50 | Batch 0/538 | Loss: 2.8972
[2025-10-15 15:14:51] Epoch 25/50 | Batch 50/538 | Loss: 3.4855
[2025-10-15 15:14:51] Epoch 25/50 | Batch 100/538 | Loss: 2.5352
[2025-10-15 15:14:51] Epoch 25/50 | Batch 150/538 | Loss: 7.7905
[2025-10-15 15:14:51] Epoch 25/50 | Batch 200/538 | Loss: 4.0080
[2025-10-15 15:14:51] Epoch 25/50 | Batch 250/538 | Loss: 4.9153
[2025-10-15 15:14:52] Epoch 25/50 | Batch 300/538 | Loss: 0.8362
[2025-10-15 15:14:52] Epoch 25/50 | Batch 350/538 | Loss: 1.3226
[2025-10-15 15:14:52] Epoch 25/50 | Batch 400/538 | Loss: 2.4444
[2025-10-15 15:14:52] Epoch 25/50 | Batch 450/538 | Loss: 2.5537
[2025-10-15 15:14:52] Epoch 25/50 | Batch 500/538 | Loss: 3.5941
[2025-10-15 15:14:52] 
Epoch 25/50 completed in 1.3s
  Train Loss:    2.8221
  Train Hit@1:   0.1989
  Val Loss:      3.1051
  Val Hit@1:     0.1081
  Val Hit@3:     0.3378
  Val Hit@10:    0.6892
  Val MRR:       0.2710
  Overfit Gap:   0.0908

[2025-10-15 15:14:52] Epoch 26/50 | Batch 0/538 | Loss: 1.9319
[2025-10-15 15:14:53] Epoch 26/50 | Batch 50/538 | Loss: 2.0860
[2025-10-15 15:14:53] Epoch 26/50 | Batch 100/538 | Loss: 5.0671
[2025-10-15 15:14:53] Epoch 26/50 | Batch 150/538 | Loss: 1.9645
[2025-10-15 15:14:53] Epoch 26/50 | Batch 200/538 | Loss: 1.4740
[2025-10-15 15:14:53] Epoch 26/50 | Batch 250/538 | Loss: 1.0514
[2025-10-15 15:14:53] Epoch 26/50 | Batch 300/538 | Loss: 2.7585
[2025-10-15 15:14:53] Epoch 26/50 | Batch 350/538 | Loss: 2.6961
[2025-10-15 15:14:53] Epoch 26/50 | Batch 400/538 | Loss: 1.3986
[2025-10-15 15:14:53] Epoch 26/50 | Batch 450/538 | Loss: 3.5776
[2025-10-15 15:14:53] Epoch 26/50 | Batch 500/538 | Loss: 1.2870
[2025-10-15 15:14:54] 
Epoch 26/50 completed in 1.3s
  Train Loss:    2.7923
  Train Hit@1:   0.2026
  Val Loss:      3.0907
  Val Hit@1:     0.1216
  Val Hit@3:     0.3243
  Val Hit@10:    0.6892
  Val MRR:       0.2776
  Overfit Gap:   0.0810

[2025-10-15 15:14:54] Epoch 27/50 | Batch 0/538 | Loss: 2.7301
[2025-10-15 15:14:54] Epoch 27/50 | Batch 50/538 | Loss: 4.5009
[2025-10-15 15:14:54] Epoch 27/50 | Batch 100/538 | Loss: 1.7913
[2025-10-15 15:14:54] Epoch 27/50 | Batch 150/538 | Loss: 4.6522
[2025-10-15 15:14:54] Epoch 27/50 | Batch 200/538 | Loss: 2.2062
[2025-10-15 15:14:54] Epoch 27/50 | Batch 250/538 | Loss: 3.9654
[2025-10-15 15:14:54] Epoch 27/50 | Batch 300/538 | Loss: 2.5923
[2025-10-15 15:14:54] Epoch 27/50 | Batch 350/538 | Loss: 2.8561
[2025-10-15 15:14:54] Epoch 27/50 | Batch 400/538 | Loss: 2.8362
[2025-10-15 15:14:54] Epoch 27/50 | Batch 450/538 | Loss: 3.3438
[2025-10-15 15:14:54] Epoch 27/50 | Batch 500/538 | Loss: 0.7817
[2025-10-15 15:14:55] 
Epoch 27/50 completed in 1.3s
  Train Loss:    2.7830
  Train Hit@1:   0.2045
  Val Loss:      3.0896
  Val Hit@1:     0.1216
  Val Hit@3:     0.3243
  Val Hit@10:    0.6757
  Val MRR:       0.2788
  Overfit Gap:   0.0828

[2025-10-15 15:14:55] Epoch 28/50 | Batch 0/538 | Loss: 2.1082
[2025-10-15 15:14:55] Epoch 28/50 | Batch 50/538 | Loss: 1.1763
[2025-10-15 15:14:55] Epoch 28/50 | Batch 100/538 | Loss: 3.2007
[2025-10-15 15:14:55] Epoch 28/50 | Batch 150/538 | Loss: 2.8225
[2025-10-15 15:14:55] Epoch 28/50 | Batch 200/538 | Loss: 5.0918
[2025-10-15 15:14:56] Epoch 28/50 | Batch 250/538 | Loss: 2.3692
[2025-10-15 15:14:56] Epoch 28/50 | Batch 300/538 | Loss: 2.3770
[2025-10-15 15:14:56] Epoch 28/50 | Batch 350/538 | Loss: 1.1411
[2025-10-15 15:14:56] Epoch 28/50 | Batch 400/538 | Loss: 2.8223
[2025-10-15 15:14:56] Epoch 28/50 | Batch 450/538 | Loss: 1.9312
[2025-10-15 15:14:56] Epoch 28/50 | Batch 500/538 | Loss: 3.1661
[2025-10-15 15:14:57] 
Epoch 28/50 completed in 1.5s
  Train Loss:    2.8379
  Train Hit@1:   0.2045
  Val Loss:      3.0911
  Val Hit@1:     0.0946
  Val Hit@3:     0.3108
  Val Hit@10:    0.6892
  Val MRR:       0.2658
  Overfit Gap:   0.1099

[2025-10-15 15:14:57] Epoch 29/50 | Batch 0/538 | Loss: 2.5888
[2025-10-15 15:14:57] Epoch 29/50 | Batch 50/538 | Loss: 4.1637
[2025-10-15 15:14:57] Epoch 29/50 | Batch 100/538 | Loss: 1.8049
[2025-10-15 15:14:57] Epoch 29/50 | Batch 150/538 | Loss: 2.8581
[2025-10-15 15:14:57] Epoch 29/50 | Batch 200/538 | Loss: 5.2107
[2025-10-15 15:14:57] Epoch 29/50 | Batch 250/538 | Loss: 4.1806
[2025-10-15 15:14:57] Epoch 29/50 | Batch 300/538 | Loss: 2.7137
[2025-10-15 15:14:57] Epoch 29/50 | Batch 350/538 | Loss: 2.8156
[2025-10-15 15:14:57] Epoch 29/50 | Batch 400/538 | Loss: 2.1840
[2025-10-15 15:14:57] Epoch 29/50 | Batch 450/538 | Loss: 1.7857
[2025-10-15 15:14:57] Epoch 29/50 | Batch 500/538 | Loss: 0.9258
[2025-10-15 15:14:58] 
Epoch 29/50 completed in 1.4s
  Train Loss:    2.7874
  Train Hit@1:   0.2026
  Val Loss:      3.0798
  Val Hit@1:     0.1081
  Val Hit@3:     0.3108
  Val Hit@10:    0.6892
  Val MRR:       0.2741
  Overfit Gap:   0.0945

[2025-10-15 15:14:58] Early stopping triggered after 29 epochs
[2025-10-15 15:14:58] 
================================================================================
[2025-10-15 15:14:58] Running final test evaluation...
[2025-10-15 15:14:58] ================================================================================

[2025-10-15 15:14:58] 
FINAL TEST RESULTS:
  Test Loss:   2.9960
  Test Hit@1:  0.1067
  Test Hit@3:  0.2533
  Test Hit@10: 0.6667
  Test MRR:    0.2596
  Test Samples: 75

[2025-10-15 15:14:58] 
Training complete! Results saved to: experiments/phase1_standard_20251015_151415
