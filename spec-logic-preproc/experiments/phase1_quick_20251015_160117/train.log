[2025-10-15 16:01:19] Starting Phase 1 training: phase1_quick_20251015_160117
[2025-10-15 16:01:19] Configuration: {
  "json_dir": "data_processed/phase1_quick_20251015_160117",
  "spectral_dir": "data_processed/phase1_quick_20251015_160117/spectral",
  "val_fraction": 0.1,
  "test_fraction": 0.1,
  "hidden_dim": 128,
  "num_layers": 2,
  "dropout": 0.1,
  "epochs": 10,
  "batch_size": 128,
  "lr": 0.0005,
  "weight_decay": 0.0001,
  "grad_clip": 1.0,
  "patience": 20,
  "exp_name": "phase1_quick_20251015_160117",
  "log_dir": "experiments",
  "device": "mps",
  "seed": 42
}
[2025-10-15 16:01:19] Using device: mps
[2025-10-15 16:01:19] Loading datasets...
[2025-10-15 16:01:19] Found 52 JSON files
[2025-10-15 16:01:19] Data split: 42 train, 5 val, 5 test
[2025-10-15 16:01:19] Dataset sizes: 57 train samples, 8 val, 13 test
[2025-10-15 16:01:19] Input features dimension: 19
[2025-10-15 16:01:20] Model parameters: 19,201
[2025-10-15 16:01:20] 
================================================================================
[2025-10-15 16:01:20] Starting training...
[2025-10-15 16:01:20] ================================================================================

[2025-10-15 16:01:20] Epoch 1/10 | Batch 0/1 | Loss: 3.1333
[2025-10-15 16:01:21] 
Epoch 1/10 completed in 1.7s
  Train Loss:    3.1333
  Train Hit@1:   0.0175
  Val Loss:      3.9781
  Val Hit@1:     0.0000
  Val Hit@3:     0.0000
  Val Hit@10:    0.1250
  Val MRR:       0.0595
  Overfit Gap:   0.0175

[2025-10-15 16:01:21] Saved best checkpoint (epoch 1)
[2025-10-15 16:01:21] Epoch 2/10 | Batch 0/1 | Loss: 3.1266
[2025-10-15 16:01:22] 
Epoch 2/10 completed in 0.8s
  Train Loss:    3.1266
  Train Hit@1:   0.0000
  Val Loss:      3.9797
  Val Hit@1:     0.0000
  Val Hit@3:     0.0000
  Val Hit@10:    0.1250
  Val MRR:       0.0568
  Overfit Gap:   0.0000

[2025-10-15 16:01:22] Epoch 3/10 | Batch 0/1 | Loss: 3.1212
[2025-10-15 16:01:23] 
Epoch 3/10 completed in 0.9s
  Train Loss:    3.1212
  Train Hit@1:   0.0000
  Val Loss:      3.9815
  Val Hit@1:     0.0000
  Val Hit@3:     0.0000
  Val Hit@10:    0.1250
  Val MRR:       0.0559
  Overfit Gap:   0.0000

[2025-10-15 16:01:23] Epoch 4/10 | Batch 0/1 | Loss: 3.1235
[2025-10-15 16:01:24] 
Epoch 4/10 completed in 0.8s
  Train Loss:    3.1235
  Train Hit@1:   0.0000
  Val Loss:      3.9835
  Val Hit@1:     0.0000
  Val Hit@3:     0.0000
  Val Hit@10:    0.1250
  Val MRR:       0.0546
  Overfit Gap:   0.0000

[2025-10-15 16:01:24] Epoch 5/10 | Batch 0/1 | Loss: 3.1175
[2025-10-15 16:01:25] 
Epoch 5/10 completed in 0.9s
  Train Loss:    3.1175
  Train Hit@1:   0.0351
  Val Loss:      3.9855
  Val Hit@1:     0.0000
  Val Hit@3:     0.0000
  Val Hit@10:    0.1250
  Val MRR:       0.0543
  Overfit Gap:   0.0351

[2025-10-15 16:01:25] Epoch 6/10 | Batch 0/1 | Loss: 3.1150
[2025-10-15 16:01:25] 
Epoch 6/10 completed in 0.8s
  Train Loss:    3.1150
  Train Hit@1:   0.0351
  Val Loss:      3.9873
  Val Hit@1:     0.0000
  Val Hit@3:     0.0000
  Val Hit@10:    0.1250
  Val MRR:       0.0553
  Overfit Gap:   0.0351

[2025-10-15 16:01:26] Epoch 7/10 | Batch 0/1 | Loss: 3.1111
[2025-10-15 16:01:26] 
Epoch 7/10 completed in 0.9s
  Train Loss:    3.1111
  Train Hit@1:   0.0351
  Val Loss:      3.9890
  Val Hit@1:     0.0000
  Val Hit@3:     0.0000
  Val Hit@10:    0.1250
  Val MRR:       0.0558
  Overfit Gap:   0.0351

[2025-10-15 16:01:27] Epoch 8/10 | Batch 0/1 | Loss: 3.1068
[2025-10-15 16:01:27] 
Epoch 8/10 completed in 0.8s
  Train Loss:    3.1068
  Train Hit@1:   0.0351
  Val Loss:      3.9898
  Val Hit@1:     0.0000
  Val Hit@3:     0.0000
  Val Hit@10:    0.1250
  Val MRR:       0.0560
  Overfit Gap:   0.0351

[2025-10-15 16:01:27] Epoch 9/10 | Batch 0/1 | Loss: 3.1068
[2025-10-15 16:01:28] 
Epoch 9/10 completed in 0.8s
  Train Loss:    3.1068
  Train Hit@1:   0.0351
  Val Loss:      3.9905
  Val Hit@1:     0.0000
  Val Hit@3:     0.0000
  Val Hit@10:    0.1250
  Val MRR:       0.0569
  Overfit Gap:   0.0351

[2025-10-15 16:01:28] Epoch 10/10 | Batch 0/1 | Loss: 3.1022
[2025-10-15 16:01:29] 
Epoch 10/10 completed in 0.8s
  Train Loss:    3.1022
  Train Hit@1:   0.0351
  Val Loss:      3.9912
  Val Hit@1:     0.0000
  Val Hit@3:     0.0000
  Val Hit@10:    0.1250
  Val MRR:       0.0569
  Overfit Gap:   0.0351

[2025-10-15 16:01:29] 
================================================================================
[2025-10-15 16:01:29] Running final test evaluation...
[2025-10-15 16:01:29] ================================================================================

[2025-10-15 16:01:29] 
FINAL TEST RESULTS:
  Test Loss:   3.2991
  Test Hit@1:  0.0000
  Test Hit@3:  0.0769
  Test Hit@10: 0.6154
  Test MRR:    0.1360
  Test Samples: 13

[2025-10-15 16:01:29] 
Training complete! Results saved to: experiments/phase1_quick_20251015_160117
