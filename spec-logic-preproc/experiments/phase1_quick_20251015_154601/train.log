[2025-10-15 15:46:03] Starting Phase 1 training: phase1_quick_20251015_154601
[2025-10-15 15:46:03] Configuration: {
  "json_dir": "data_processed/phase1_quick_20251015_154601",
  "spectral_dir": "data_processed/phase1_quick_20251015_154601/spectral",
  "val_fraction": 0.1,
  "test_fraction": 0.1,
  "hidden_dim": 128,
  "num_layers": 2,
  "dropout": 0.1,
  "epochs": 10,
  "batch_size": 64,
  "lr": 0.001,
  "weight_decay": 0.0001,
  "grad_clip": 1.0,
  "patience": 20,
  "exp_name": "phase1_quick_20251015_154601",
  "log_dir": "experiments",
  "device": "mps",
  "seed": 42
}
[2025-10-15 15:46:03] Using device: mps
[2025-10-15 15:46:03] Loading datasets...
[2025-10-15 15:46:03] Found 52 JSON files
[2025-10-15 15:46:03] Data split: 42 train, 5 val, 5 test
[2025-10-15 15:46:03] Dataset sizes: 62 train samples, 12 val, 6 test
[2025-10-15 15:46:03] Input features dimension: 19
[2025-10-15 15:46:03] Model parameters: 19,201
[2025-10-15 15:46:03] 
================================================================================
[2025-10-15 15:46:03] Starting training...
[2025-10-15 15:46:03] ================================================================================

[2025-10-15 15:46:04] Epoch 1/10 | Batch 0/1 | Loss: 3.1266
[2025-10-15 15:46:05] 
Epoch 1/10 completed in 2.1s
  Train Loss:    3.1266
  Train Hit@1:   0.0161
  Val Loss:      3.8978
  Val Hit@1:     0.0000
  Val Hit@3:     0.0833
  Val Hit@10:    0.3333
  Val MRR:       0.0774
  Overfit Gap:   0.0161

[2025-10-15 15:46:05] Saved best checkpoint (epoch 1)
[2025-10-15 15:46:06] Epoch 2/10 | Batch 0/1 | Loss: 3.1219
[2025-10-15 15:46:06] 
Epoch 2/10 completed in 1.0s
  Train Loss:    3.1219
  Train Hit@1:   0.0484
  Val Loss:      3.8968
  Val Hit@1:     0.0000
  Val Hit@3:     0.0833
  Val Hit@10:    0.3333
  Val MRR:       0.0964
  Overfit Gap:   0.0484

[2025-10-15 15:46:07] Epoch 3/10 | Batch 0/1 | Loss: 3.1127
[2025-10-15 15:46:07] 
Epoch 3/10 completed in 1.0s
  Train Loss:    3.1127
  Train Hit@1:   0.0484
  Val Loss:      3.8952
  Val Hit@1:     0.0000
  Val Hit@3:     0.1667
  Val Hit@10:    0.3333
  Val MRR:       0.1050
  Overfit Gap:   0.0484

[2025-10-15 15:46:08] Epoch 4/10 | Batch 0/1 | Loss: 3.1103
[2025-10-15 15:46:08] 
Epoch 4/10 completed in 0.9s
  Train Loss:    3.1103
  Train Hit@1:   0.0806
  Val Loss:      3.8930
  Val Hit@1:     0.0833
  Val Hit@3:     0.1667
  Val Hit@10:    0.3333
  Val MRR:       0.1466
  Overfit Gap:   -0.0027

[2025-10-15 15:46:08] Saved best checkpoint (epoch 4)
[2025-10-15 15:46:09] Epoch 5/10 | Batch 0/1 | Loss: 3.1011
[2025-10-15 15:46:09] 
Epoch 5/10 completed in 1.0s
  Train Loss:    3.1011
  Train Hit@1:   0.0968
  Val Loss:      3.8903
  Val Hit@1:     0.0833
  Val Hit@3:     0.1667
  Val Hit@10:    0.3333
  Val MRR:       0.1457
  Overfit Gap:   0.0134

[2025-10-15 15:46:10] Epoch 6/10 | Batch 0/1 | Loss: 3.0965
[2025-10-15 15:46:10] 
Epoch 6/10 completed in 1.0s
  Train Loss:    3.0965
  Train Hit@1:   0.0968
  Val Loss:      3.8878
  Val Hit@1:     0.0833
  Val Hit@3:     0.1667
  Val Hit@10:    0.3333
  Val MRR:       0.1464
  Overfit Gap:   0.0134

[2025-10-15 15:46:11] Epoch 7/10 | Batch 0/1 | Loss: 3.0909
[2025-10-15 15:46:12] 
Epoch 7/10 completed in 1.2s
  Train Loss:    3.0909
  Train Hit@1:   0.0806
  Val Loss:      3.8852
  Val Hit@1:     0.0833
  Val Hit@3:     0.0833
  Val Hit@10:    0.3333
  Val MRR:       0.1399
  Overfit Gap:   -0.0027

[2025-10-15 15:46:12] Epoch 8/10 | Batch 0/1 | Loss: 3.0834
[2025-10-15 15:46:13] 
Epoch 8/10 completed in 1.4s
  Train Loss:    3.0834
  Train Hit@1:   0.0806
  Val Loss:      3.8826
  Val Hit@1:     0.0833
  Val Hit@3:     0.0833
  Val Hit@10:    0.3333
  Val MRR:       0.1414
  Overfit Gap:   -0.0027

[2025-10-15 15:46:13] Epoch 9/10 | Batch 0/1 | Loss: 3.0722
[2025-10-15 15:46:15] 
Epoch 9/10 completed in 1.5s
  Train Loss:    3.0722
  Train Hit@1:   0.0806
  Val Loss:      3.8799
  Val Hit@1:     0.0833
  Val Hit@3:     0.0833
  Val Hit@10:    0.3333
  Val MRR:       0.1412
  Overfit Gap:   -0.0027

[2025-10-15 15:46:15] Epoch 10/10 | Batch 0/1 | Loss: 3.0631
[2025-10-15 15:46:16] 
Epoch 10/10 completed in 1.2s
  Train Loss:    3.0631
  Train Hit@1:   0.0645
  Val Loss:      3.8773
  Val Hit@1:     0.0833
  Val Hit@3:     0.0833
  Val Hit@10:    0.3333
  Val MRR:       0.1441
  Overfit Gap:   -0.0188

[2025-10-15 15:46:16] 
================================================================================
[2025-10-15 15:46:16] Running final test evaluation...
[2025-10-15 15:46:16] ================================================================================

[2025-10-15 15:46:16] 
FINAL TEST RESULTS:
  Test Loss:   3.0435
  Test Hit@1:  0.0000
  Test Hit@3:  0.0000
  Test Hit@10: 0.6667
  Test MRR:    0.1448
  Test Samples: 6

[2025-10-15 15:46:16] 
Training complete! Results saved to: experiments/phase1_quick_20251015_154601
