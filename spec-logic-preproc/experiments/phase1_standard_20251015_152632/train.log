[2025-10-15 15:26:36] Starting Phase 1 training: phase1_standard_20251015_152632
[2025-10-15 15:26:36] Configuration: {
  "json_dir": "data_processed/phase1_standard_20251015_152632",
  "spectral_dir": "data_processed/phase1_standard_20251015_152632/spectral",
  "val_fraction": 0.1,
  "test_fraction": 0.1,
  "hidden_dim": 128,
  "num_layers": 2,
  "dropout": 0.3,
  "epochs": 50,
  "batch_size": 32,
  "lr": 0.0005,
  "weight_decay": 0.0001,
  "grad_clip": 0.5,
  "patience": 10,
  "exp_name": "phase1_standard_20251015_152632",
  "log_dir": "experiments",
  "device": "mps",
  "seed": 42
}
[2025-10-15 15:26:36] Using device: mps
[2025-10-15 15:26:36] Loading datasets...
[2025-10-15 15:26:36] Found 451 JSON files
[2025-10-15 15:26:36] Data split: 361 train, 45 val, 45 test
[2025-10-15 15:26:36] Dataset sizes: 544 train samples, 64 val, 69 test
[2025-10-15 15:26:36] Input features dimension: 19
[2025-10-15 15:26:36] Model parameters: 19,201
[2025-10-15 15:26:36] 
================================================================================
[2025-10-15 15:26:36] Starting training...
[2025-10-15 15:26:36] ================================================================================

[2025-10-15 15:26:36] Epoch 1/50 | Batch 0/17 | Loss: 3.5027
[2025-10-15 15:26:49] 
Epoch 1/50 completed in 13.8s
  Train Loss:    3.4020
  Train Hit@1:   0.0772
  Val Loss:      3.3831
  Val Hit@1:     0.0625
  Val Hit@3:     0.2500
  Val Hit@10:    0.5625
  Val MRR:       0.2244
  Overfit Gap:   0.0147

[2025-10-15 15:26:49] Saved best checkpoint (epoch 1)
[2025-10-15 15:26:50] Epoch 2/50 | Batch 0/17 | Loss: 3.4223
[2025-10-15 15:27:00] 
Epoch 2/50 completed in 10.3s
  Train Loss:    3.3522
  Train Hit@1:   0.0846
  Val Loss:      3.3394
  Val Hit@1:     0.0469
  Val Hit@3:     0.2344
  Val Hit@10:    0.5938
  Val MRR:       0.2113
  Overfit Gap:   0.0377

[2025-10-15 15:27:00] Epoch 3/50 | Batch 0/17 | Loss: 3.4254
[2025-10-15 15:27:10] 
Epoch 3/50 completed in 10.8s
  Train Loss:    3.2981
  Train Hit@1:   0.0864
  Val Loss:      3.2832
  Val Hit@1:     0.0312
  Val Hit@3:     0.2344
  Val Hit@10:    0.5781
  Val MRR:       0.2044
  Overfit Gap:   0.0551

[2025-10-15 15:27:11] Epoch 4/50 | Batch 0/17 | Loss: 3.1410
[2025-10-15 15:27:22] 
Epoch 4/50 completed in 11.5s
  Train Loss:    3.2569
  Train Hit@1:   0.0846
  Val Loss:      3.2197
  Val Hit@1:     0.0312
  Val Hit@3:     0.2188
  Val Hit@10:    0.6719
  Val MRR:       0.2053
  Overfit Gap:   0.0533

[2025-10-15 15:27:22] Epoch 5/50 | Batch 0/17 | Loss: 3.1328
[2025-10-15 15:27:33] 
Epoch 5/50 completed in 10.8s
  Train Loss:    3.1844
  Train Hit@1:   0.0662
  Val Loss:      3.1536
  Val Hit@1:     0.0312
  Val Hit@3:     0.2031
  Val Hit@10:    0.7031
  Val MRR:       0.2003
  Overfit Gap:   0.0349

[2025-10-15 15:27:33] Epoch 6/50 | Batch 0/17 | Loss: 3.0742
[2025-10-15 15:27:43] 
Epoch 6/50 completed in 10.6s
  Train Loss:    3.1224
  Train Hit@1:   0.0662
  Val Loss:      3.0967
  Val Hit@1:     0.0312
  Val Hit@3:     0.1719
  Val Hit@10:    0.7344
  Val MRR:       0.1967
  Overfit Gap:   0.0349

[2025-10-15 15:27:44] Epoch 7/50 | Batch 0/17 | Loss: 3.0045
[2025-10-15 15:27:54] 
Epoch 7/50 completed in 10.7s
  Train Loss:    3.0847
  Train Hit@1:   0.0515
  Val Loss:      3.0574
  Val Hit@1:     0.0469
  Val Hit@3:     0.1719
  Val Hit@10:    0.7500
  Val MRR:       0.2062
  Overfit Gap:   0.0046

[2025-10-15 15:27:54] Epoch 8/50 | Batch 0/17 | Loss: 3.1346
[2025-10-15 15:28:06] 
Epoch 8/50 completed in 12.0s
  Train Loss:    3.0551
  Train Hit@1:   0.0460
  Val Loss:      3.0425
  Val Hit@1:     0.0312
  Val Hit@3:     0.1719
  Val Hit@10:    0.7656
  Val MRR:       0.1977
  Overfit Gap:   0.0147

[2025-10-15 15:28:06] Epoch 9/50 | Batch 0/17 | Loss: 3.1311
[2025-10-15 15:28:18] 
Epoch 9/50 completed in 11.6s
  Train Loss:    3.0566
  Train Hit@1:   0.0423
  Val Loss:      3.0309
  Val Hit@1:     0.0312
  Val Hit@3:     0.1875
  Val Hit@10:    0.7656
  Val MRR:       0.2042
  Overfit Gap:   0.0110

[2025-10-15 15:28:18] Epoch 10/50 | Batch 0/17 | Loss: 3.0040
[2025-10-15 15:28:30] 
Epoch 10/50 completed in 12.2s
  Train Loss:    3.0390
  Train Hit@1:   0.0478
  Val Loss:      3.0219
  Val Hit@1:     0.0312
  Val Hit@3:     0.1875
  Val Hit@10:    0.7656
  Val MRR:       0.2056
  Overfit Gap:   0.0165

[2025-10-15 15:28:30] Epoch 11/50 | Batch 0/17 | Loss: 2.9959
[2025-10-15 15:28:41] 
Epoch 11/50 completed in 11.1s
  Train Loss:    3.0383
  Train Hit@1:   0.0533
  Val Loss:      3.0140
  Val Hit@1:     0.0312
  Val Hit@3:     0.1875
  Val Hit@10:    0.7969
  Val MRR:       0.2088
  Overfit Gap:   0.0221

[2025-10-15 15:28:41] Early stopping triggered after 11 epochs
[2025-10-15 15:28:41] 
================================================================================
[2025-10-15 15:28:41] Running final test evaluation...
[2025-10-15 15:28:41] ================================================================================

[2025-10-15 15:28:45] 
FINAL TEST RESULTS:
  Test Loss:   3.5465
  Test Hit@1:  0.0290
  Test Hit@3:  0.1739
  Test Hit@10: 0.4058
  Test MRR:    0.1588
  Test Samples: 69

[2025-10-15 15:28:45] 
Training complete! Results saved to: experiments/phase1_standard_20251015_152632
