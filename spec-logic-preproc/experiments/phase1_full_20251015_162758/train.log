[2025-10-15 16:28:03] Starting Phase 1 training: phase1_full_20251015_162758
[2025-10-15 16:28:03] Configuration: {
  "json_dir": "data_processed/phase1_full_20251015_162758",
  "spectral_dir": "data_processed/phase1_full_20251015_162758/spectral",
  "val_fraction": 0.1,
  "test_fraction": 0.1,
  "hidden_dim": 256,
  "num_layers": 4,
  "dropout": 0.2,
  "epochs": 100,
  "batch_size": 256,
  "lr": 0.0003,
  "weight_decay": 0.0001,
  "grad_clip": 1.0,
  "patience": 20,
  "exp_name": "phase1_full_20251015_162758",
  "log_dir": "experiments",
  "device": "mps",
  "seed": 42
}
[2025-10-15 16:28:03] Using device: mps
[2025-10-15 16:28:03] Loading datasets...
[2025-10-15 16:28:03] Found 1001 JSON files
[2025-10-15 16:28:03] Data split: 801 train, 100 val, 100 test
[2025-10-15 16:28:03] Dataset sizes: 1240 train samples, 144 val, 136 test
[2025-10-15 16:28:03] Input features dimension: 19
[2025-10-15 16:28:03] Model parameters: 204,801
[2025-10-15 16:28:03] 
================================================================================
[2025-10-15 16:28:03] Starting training...
[2025-10-15 16:28:03] ================================================================================

[2025-10-15 16:28:07] Epoch 1/100 | Batch 0/5 | Loss: 3.6463
[2025-10-15 16:28:33] 
Epoch 1/100 completed in 30.3s
  Train Loss:    3.6045
  Train Hit@1:   0.0379
  Val Loss:      3.4176
  Val Hit@1:     0.0556
  Val Hit@3:     0.2014
  Val Hit@10:    0.4097
  Val MRR:       0.1836
  Overfit Gap:   -0.0177

[2025-10-15 16:28:33] Saved best checkpoint (epoch 1)
[2025-10-15 16:28:35] Epoch 2/100 | Batch 0/5 | Loss: 3.5020
[2025-10-15 16:29:00] 
Epoch 2/100 completed in 26.7s
  Train Loss:    3.4959
  Train Hit@1:   0.0653
  Val Loss:      3.4021
  Val Hit@1:     0.0903
  Val Hit@3:     0.2292
  Val Hit@10:    0.4514
  Val MRR:       0.2179
  Overfit Gap:   -0.0250

[2025-10-15 16:29:00] Saved best checkpoint (epoch 2)
[2025-10-15 16:29:06] Epoch 3/100 | Batch 0/5 | Loss: 3.4775
[2025-10-15 16:29:35] 
Epoch 3/100 completed in 35.3s
  Train Loss:    3.4457
  Train Hit@1:   0.0823
  Val Loss:      3.3967
  Val Hit@1:     0.1250
  Val Hit@3:     0.2500
  Val Hit@10:    0.4861
  Val MRR:       0.2341
  Overfit Gap:   -0.0427

[2025-10-15 16:29:35] Saved best checkpoint (epoch 3)
[2025-10-15 16:29:39] Epoch 4/100 | Batch 0/5 | Loss: 3.4509
[2025-10-15 16:30:08] 
Epoch 4/100 completed in 32.9s
  Train Loss:    3.4150
  Train Hit@1:   0.0927
  Val Loss:      3.3978
  Val Hit@1:     0.0903
  Val Hit@3:     0.2292
  Val Hit@10:    0.4861
  Val MRR:       0.2118
  Overfit Gap:   0.0025

[2025-10-15 16:30:10] Epoch 5/100 | Batch 0/5 | Loss: 3.3691
[2025-10-15 16:30:33] 
Epoch 5/100 completed in 25.1s
  Train Loss:    3.3745
  Train Hit@1:   0.0806
  Val Loss:      3.4076
  Val Hit@1:     0.0556
  Val Hit@3:     0.1944
  Val Hit@10:    0.5139
  Val MRR:       0.1836
  Overfit Gap:   0.0251

[2025-10-15 16:30:35] Epoch 6/100 | Batch 0/5 | Loss: 3.3579
[2025-10-15 16:30:58] 
Epoch 6/100 completed in 25.2s
  Train Loss:    3.3478
  Train Hit@1:   0.0839
  Val Loss:      3.4067
  Val Hit@1:     0.0556
  Val Hit@3:     0.1806
  Val Hit@10:    0.5000
  Val MRR:       0.1838
  Overfit Gap:   0.0283

[2025-10-15 16:31:00] Epoch 7/100 | Batch 0/5 | Loss: 3.3793
[2025-10-15 16:31:26] 
Epoch 7/100 completed in 27.4s
  Train Loss:    3.3216
  Train Hit@1:   0.0919
  Val Loss:      3.4002
  Val Hit@1:     0.0833
  Val Hit@3:     0.1667
  Val Hit@10:    0.4653
  Val MRR:       0.1945
  Overfit Gap:   0.0086

[2025-10-15 16:31:28] Epoch 8/100 | Batch 0/5 | Loss: 3.2769
[2025-10-15 16:31:52] 
Epoch 8/100 completed in 26.1s
  Train Loss:    3.3085
  Train Hit@1:   0.0968
  Val Loss:      3.3885
  Val Hit@1:     0.1042
  Val Hit@3:     0.1806
  Val Hit@10:    0.5069
  Val MRR:       0.2124
  Overfit Gap:   -0.0074

[2025-10-15 16:31:54] Epoch 9/100 | Batch 0/5 | Loss: 3.2662
[2025-10-15 16:32:18] 
Epoch 9/100 completed in 25.7s
  Train Loss:    3.3080
  Train Hit@1:   0.1056
  Val Loss:      3.3686
  Val Hit@1:     0.1111
  Val Hit@3:     0.2014
  Val Hit@10:    0.5278
  Val MRR:       0.2205
  Overfit Gap:   -0.0055

[2025-10-15 16:32:20] Epoch 10/100 | Batch 0/5 | Loss: 3.2997
[2025-10-15 16:32:44] 
Epoch 10/100 completed in 26.4s
  Train Loss:    3.2715
  Train Hit@1:   0.1081
  Val Loss:      3.3602
  Val Hit@1:     0.1111
  Val Hit@3:     0.2292
  Val Hit@10:    0.5625
  Val MRR:       0.2265
  Overfit Gap:   -0.0030

[2025-10-15 16:32:46] Epoch 11/100 | Batch 0/5 | Loss: 3.2441
[2025-10-15 16:33:04] 
Epoch 11/100 completed in 19.9s
  Train Loss:    3.2721
  Train Hit@1:   0.1089
  Val Loss:      3.3596
  Val Hit@1:     0.1042
  Val Hit@3:     0.2361
  Val Hit@10:    0.5417
  Val MRR:       0.2247
  Overfit Gap:   0.0047

[2025-10-15 16:33:06] Epoch 12/100 | Batch 0/5 | Loss: 3.3481
[2025-10-15 16:33:30] 
Epoch 12/100 completed in 25.6s
  Train Loss:    3.2774
  Train Hit@1:   0.1081
  Val Loss:      3.3612
  Val Hit@1:     0.0972
  Val Hit@3:     0.2222
  Val Hit@10:    0.5069
  Val MRR:       0.2199
  Overfit Gap:   0.0108

[2025-10-15 16:33:32] Epoch 13/100 | Batch 0/5 | Loss: 3.2520
[2025-10-15 16:33:56] 
Epoch 13/100 completed in 26.1s
  Train Loss:    3.2521
  Train Hit@1:   0.1089
  Val Loss:      3.3548
  Val Hit@1:     0.1111
  Val Hit@3:     0.2153
  Val Hit@10:    0.5208
  Val MRR:       0.2289
  Overfit Gap:   -0.0022

[2025-10-15 16:33:58] Epoch 14/100 | Batch 0/5 | Loss: 3.2574
[2025-10-15 16:34:23] 
Epoch 14/100 completed in 26.8s
  Train Loss:    3.2558
  Train Hit@1:   0.1065
  Val Loss:      3.3486
  Val Hit@1:     0.1111
  Val Hit@3:     0.2292
  Val Hit@10:    0.5347
  Val MRR:       0.2302
  Overfit Gap:   -0.0047

[2025-10-15 16:34:25] Epoch 15/100 | Batch 0/5 | Loss: 3.1967
[2025-10-15 16:34:46] 
Epoch 15/100 completed in 23.8s
  Train Loss:    3.2411
  Train Hit@1:   0.1040
  Val Loss:      3.3452
  Val Hit@1:     0.1181
  Val Hit@3:     0.2292
  Val Hit@10:    0.5417
  Val MRR:       0.2327
  Overfit Gap:   -0.0140

[2025-10-15 16:34:49] Epoch 16/100 | Batch 0/5 | Loss: 3.2557
[2025-10-15 16:35:14] 
Epoch 16/100 completed in 27.1s
  Train Loss:    3.2427
  Train Hit@1:   0.1048
  Val Loss:      3.3450
  Val Hit@1:     0.1181
  Val Hit@3:     0.2222
  Val Hit@10:    0.5417
  Val MRR:       0.2325
  Overfit Gap:   -0.0132

[2025-10-15 16:35:16] Epoch 17/100 | Batch 0/5 | Loss: 3.2448
[2025-10-15 16:35:41] 
Epoch 17/100 completed in 27.1s
  Train Loss:    3.2390
  Train Hit@1:   0.1081
  Val Loss:      3.3452
  Val Hit@1:     0.1181
  Val Hit@3:     0.2361
  Val Hit@10:    0.5486
  Val MRR:       0.2331
  Overfit Gap:   -0.0100

[2025-10-15 16:35:43] Epoch 18/100 | Batch 0/5 | Loss: 3.1956
[2025-10-15 16:36:08] 
Epoch 18/100 completed in 27.0s
  Train Loss:    3.2261
  Train Hit@1:   0.1129
  Val Loss:      3.3457
  Val Hit@1:     0.1111
  Val Hit@3:     0.2361
  Val Hit@10:    0.5417
  Val MRR:       0.2269
  Overfit Gap:   0.0018

[2025-10-15 16:36:10] Epoch 19/100 | Batch 0/5 | Loss: 3.3115
[2025-10-15 16:36:30] 
Epoch 19/100 completed in 22.1s
  Train Loss:    3.2265
  Train Hit@1:   0.1137
  Val Loss:      3.3456
  Val Hit@1:     0.1181
  Val Hit@3:     0.2292
  Val Hit@10:    0.5347
  Val MRR:       0.2298
  Overfit Gap:   -0.0043

[2025-10-15 16:36:32] Epoch 20/100 | Batch 0/5 | Loss: 3.2351
[2025-10-15 16:36:58] 
Epoch 20/100 completed in 28.5s
  Train Loss:    3.2292
  Train Hit@1:   0.1113
  Val Loss:      3.3430
  Val Hit@1:     0.1250
  Val Hit@3:     0.2292
  Val Hit@10:    0.5486
  Val MRR:       0.2340
  Overfit Gap:   -0.0137

[2025-10-15 16:37:01] Epoch 21/100 | Batch 0/5 | Loss: 3.2400
[2025-10-15 16:37:26] 
Epoch 21/100 completed in 27.7s
  Train Loss:    3.2082
  Train Hit@1:   0.1137
  Val Loss:      3.3440
  Val Hit@1:     0.1250
  Val Hit@3:     0.2222
  Val Hit@10:    0.5347
  Val MRR:       0.2331
  Overfit Gap:   -0.0113

[2025-10-15 16:37:28] Epoch 22/100 | Batch 0/5 | Loss: 3.2315
[2025-10-15 16:37:54] 
Epoch 22/100 completed in 27.8s
  Train Loss:    3.2244
  Train Hit@1:   0.1145
  Val Loss:      3.3433
  Val Hit@1:     0.1250
  Val Hit@3:     0.2153
  Val Hit@10:    0.5417
  Val MRR:       0.2342
  Overfit Gap:   -0.0105

